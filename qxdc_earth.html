<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>地球测试</title>
    <script src="lib/echarts.min.js"></script>
    <script src="lib/jquery-1.8.2.min.js"></script>
    <script src="lib/echarts-gl.min.js"></script>
    <script src="lib/world.js"></script>
    <script src="lib/china.js"></script>
    <style>
        #chart-panel {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            /*padding: 10px 10px 20px 10px;*/
        }

    </style>

</head>
<body>
<div id="chart-panel" style="position: absolute;width: 1020px;left: 0px;top:160px;"></div>
<script type="text/javascript">
    var theCountryGps = {
        "安道尔": [103.88435769674825, 36.049639729663575],
        "南极洲": [107.90156944246637, 34.38438779657531],
        "亚美尼亚": [119.5821008341542, 31.99910775872668],
        "澳大利亚": [121.41870908660299, 37.543317132551],
        "巴哈马群岛": [113.50274366574439, 23.48537557860286],
        "巴林": [107.13930848696766, 23.67103113512975],
        "伯利兹": [118.80515232386048, 32.03380248187306],
        "布维岛": [104.54775446002212, 24.3516348733308],
        "巴西": [106.15018118391723, 24.95260439133512],
        "英属印度洋领地": [125.25315316888886, 43.84949291197246],
        "文莱达鲁萨兰国": [102.71740456612355, 25.050359974495684],
        "布吉纳法索": [97.79173532074041, 28.725145506386074],
        "布隆迪": [86.05094327993068, 44.30098732496546],
        "柬埔寨": [108.40012933165896, 22.827430839873834],
        "中非共和国": [100.06487566684491, 36.53834236481261],
        "中国": [104.11412925347894, 37.5503394745908],
        "圣诞岛": [113.37392054717864, 22.52952365428473],
        "COCOS(KEELING)岛": [121.38527580660713, 31.23621958995528],
        "哥伦比亚": [116.41830383138435, 39.91572050181348],
        "刚果": [102.55107522883276, 28.06587635532283],
        "库克群岛": [86.37604846895256, 47.10040674324086],
        "古巴": [121.45637834509556, 31.216168331604926],
        "塞浦路斯": [118.38111897208434, 31.360294304735774],
        "捷克共和国": [100.06487566684491, 36.53834236481261],
        "丹麦": [78.90265546019965, 31.89203091755371],
        "多米尼加共和国": [100.06487566684491, 36.53834236481261],
        "萨尔瓦多": [102.70513756928685, 25.057140677634397],
        "福克兰群岛(马尔维纳斯)": [117.86828280447489, 36.07710023478769],
        "法罗群岛": [116.40785309958981, 39.97659759554836],
        "芬兰": [116.75197132972882, 23.36782102363423],
        "法国南部地区": [105.92351381942034, 31.349802866478562],
        "乔治亚州": [107.80054327666042, 30.671980435117],
        "加纳": [90.88338107229625, 28.53686806599189],
        "直布罗陀": [91.0353223346792, 29.970439073856888],
        "希腊": [121.38997367493266, 31.199185165607044],
        "格陵兰岛": [103.85445050123509, 30.691276306672773],
        "海地": [101.23941213985906, 36.65952428969399],
        "听到岛和麦当劳的岛屿": [116.60027003562367, 40.0850760146558],
        "香港": [114.18612410257077, 22.29358599327966],
        "冰岛": [117.88883556293278, 31.616820386103335],
        "印尼": [114.19809384382617, 22.281475883972636],
        "伊拉克": [103.84081206766041, 30.047412507142596],
        "爱尔兰": [116.70122199869957, 39.51033013277607],
        "日本": [99.77874898872787, 32.7983219757217],
        "肯尼亚": [103.63190768080493, 30.989906330940624],
        "老挝人民民主共和国": [100.06487566684491, 36.53834236481261],
        "黎巴嫩": [120.6420364954659, 28.048763389060575],
        "阿拉伯利比亚民众国": [121.80636801271983, 39.272760431853726],
        "卢森堡": [126.61131847754994, 45.74985848804471],
        "澳门": [113.55751910182492, 22.204117988443336],
        "马达加斯加": [113.32462203218046, 23.004776623374042],
        "马来西亚": [114.18267730433013, 22.282147757399187],
        "马尔代夫": [115.55292425463193, 28.052402175567224],
        "马里": [119.8908163513591, 30.22882626407136],
        "马绍尔群岛": [121.45493589551444, 31.217185342406456],
        "摩纳哥": [121.4839446058565, 31.288932258504552],
        "蒙古": [99.03826733074737, 30.724822165709803],
        "摩洛哥": [118.1143333387414, 24.486679095004362],
        "缅甸": [114.18534320559121, 22.29985390606831],
        "尼泊尔": [101.78304536262323, 36.62615284387773],
        "荷兰": [121.16459220006304, 28.797275157891544],
        "新西兰": [120.30681512660308, 31.583212088680877],
        "尼加拉瓜": [93.22158267531093, 27.970829820951696],
        "阿曼": [121.6689901510789, 42.01757766433661],
        "巴基斯坦": [121.20213587010035, 40.90983980830981],
        "巴布新几内亚": [100.52635341350383, 32.78067081182345],
        "波兰": [107.3798739874091, 25.005490550972596],
        "葡萄牙": [125.39439425356193, 43.92647255595693],
        "俄罗斯联邦": [126.63279440302125, 45.77443571637344],
        "圣马力诺": [118.54400680400435, 37.47755564068211],
        "圣多美和王子": [117.03319057485879, 28.248944211766087],
        "塞尔维亚和黑山": [120.66736348090424, 28.015890517417617],
        "新加坡": [105.96171430208666, 26.258323531902303],
        "所罗门群岛": [120.5818365686548, 30.001461232696954],
        "索马里": [109.41951583661647, 24.319449246977882],
        "南乔治亚岛和南桑威奇群岛": [129.48835855423962, 42.90073716687253],
        "西班牙": [114.54557206921461, 29.029143122064816],
        "斯里兰卡": [120.63534138138358, 27.779593437217],
        "苏丹": [100.1951253541167, 35.16924052334965],
        "斯瓦尔巴群岛和扬马延岛": [102.46962211065802, 28.38986468002573],
        "瑞典": [113.16259417602613, 27.84037726529043],
        "瑞士": [114.03297894192342, 22.650238448620915],
        "阿拉伯叙利亚共和国": [100.06487566684491, 36.53834236481261],
        "多哥": [99.01459854450935, 32.29310242553675],
        "特克斯和凯科斯群岛": [82.0068523555032, 42.92556351509277],
        "乌克兰": [121.45493589551444, 31.217185342406456],
        "阿拉伯联合酋长国": [121.80636801271983, 39.272760431853726],
        "联合王国": [125.9825396533969, 43.20633837780596],
        "美国": [122.26138733150282, 40.68351161514384],
        "美国小离岛": [122.26138733150282, 40.68351161514384],
        "乌拉圭": [121.45482055308695, 31.217060190116932]
    };
    var theChart = null;
    var canvas = document.createElement('canvas');
    var mapChart = echarts.init(canvas, null, {
        width: 4096,
        height: 2048
    });
    mapChart.setOption({
        backgroundColor:'#183363',//'rgba(44,75,138,0.8)',//#2c4b8a
        series: [{
            type: 'map',
            map: 'world',

            // 绘制完整尺寸的 echarts 实例
            top: 0,
            left: 0,
            right: 0,
            bottom: 0,
            hoverable: false,//点击不反应
            itemStyle: {
                normal: {
                    //areaColor: '#0040a3',
                    //borderColor: '#49ffff'
                    //areaColor: '#0040a3',
                    //borderColor: '#49ffff'
                    borderColor:'#49ffff',// 'rgba(100,149,237,1)',
                    areaColor: '#3997d3',//'#2b7ecc',
                    borderWidth: 1,
                    areaStyle: {
                        color: '#2b7ecc'
                    },
                    label:{
                        show:true,
                        color:'white'
                    }
                },

            },
            emphasis:{
                label:{
                    textStyle:{
                        color:'white',
                    }
                },
                itemStyle:{
                    normal: {
                        //areaColor: '#0040a3',
                        //borderColor: '#49ffff'
                        //areaColor: '#0040a3',
                        //borderColor: '#49ffff'
                        borderColor:'#49ffff',// 'rgba(100,149,237,1)',
                        areaColor: '#3997d3',//'#2b7ecc',
                        borderWidth: 1,
                        areaStyle: {
                            color: '#2b7ecc'
                        },
                        label:{
                            show:true,
                            color:'white'
                        }
                    },
                },
            },
            boundingCoords: [
                [-180, 90],
                [180, -90]
            ]
        }]
    });
    theChart = echarts.init(document.getElementById('chart-panel'));

    //默认的配置信息
    var option = {
        title: {
            // text: 'Click on an area for more detail',
            textStyle: {
                color: '#fff'
            }
        },
        //backgroundColor: '#333',
        tooltip: {
            show: true
        },

        globe: {
            baseTexture: mapChart,
            shading:'color',
            label:{
                show:true,
            },
            // shading: 'lambert',
            light: { // 光照阴影
                main: {
                    color: '#fff', // 光照颜色
                    intensity: 1.2, // 光照强度
                    // shadowQuality: 'high', //阴影亮度
                    shadow: false, // 是否显示阴影
                    alpha: 40,
                    beta: 40
                },
                ambient: {
                    intensity: 0.5
                }
            },
            emphasis:{
                label:{
                    textStyle:{
                        color:'white',
                    }
                },
                itemStyle:{
                    color:'#3997d3'
                },
            },
            viewControl: {
                alpha: 30,
                beta: 160,
                // targetCoord: [116.46, 39.92],
                autoRotateSpeed:30,
                autoRotate: true,
                autoRotateDirection:'ccw',
                autoRotateAfterStill: 10,
                distance: 240,
                zoomSensitivity:0,
                rotateSensitivity: [1, 0]
            }
        },
        series: [{
            name: 'lines3D',
            type: 'lines3D',
            coordinateSystem: 'globe',
            effect: {
                show: true
            },
            blendMode: 'lighter',
            lineStyle: {
                color:'#00c7ff',
                width: 1
            },
            data: [],
            silent: false
        }]
    }
    // 随机数据
    var theDefuatData = [];
    /*for (let i = 0; i < 10; i++) {
        theDefuatData.push(rodamData());
    }*/
   // option.series[0].data = theDefuatData;
    if(parent&&parent.PageView&&parent.PageView.currentTable){
        refresh(parent.PageView.currentTable||[]);
    }
    function rodamData() {
        let name = '随机点' + Math.random().toFixed(5) * 100000
        // let longitude = Math.random() * 62 + 73
        let longitude = Math.random() * 360
        let longitude2 = Math.random() * 360 - 180
        // let latitude = Math.random() * 50 + 3.52
        let latitude = Math.random() * 360
        let latitude2 = Math.random() * 180 - 90
        return {
            coords: [
                [longitude2, latitude2],
                [longitude, latitude]
            ],
            value: (Math.random() * 3000).toFixed(2)
        }
    }


    theChart.setOption(option);

    // 点击地球获取该区域地图
    /***
     * 刷新展示信息
     * @param data
     */
    function refresh(data) {
        //debugger;
        data = data || [];
        var theData = [];
        for (var i = 0; i < data.length; i++) {
            var theItem = data[i];
            var theFromName = theItem.from;
            var theToName = theItem.area;
            if(!theCountryGps[theToName]){
                console.log('未找到坐标:'+theToName);
                continue;
            }
            theData.push(
                {
                    coords: [
                        theCountryGps['中国'],
                        theCountryGps[theToName]
                    ],
                    value: theItem.value || 0
                });
        }
        option.series[0].data = theData;
        theChart.setOption(option);
    }
</script>
</body>
</html>